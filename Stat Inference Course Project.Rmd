---
title: "Statistical_Inference"
output: html_document
---

This document examines the relationships between population mean, variance vs sample mean, variance via simulation in the light of the Central Limit Theorem.

## Simulations

In our analysis we’ll have sample dataset of 40 points from an exponential distribution. Exponential distribution has a lambda value of 0.2 Exponential distribution is a continuous function with mean and std deviation of 1/lambda.
Let's do a thousand simulated averages of 40 exponentials.

Parameters

```{r}
set.seed(3)
lambda <- 0.2
nosim <- 1000
sample_size <- 40
```

Matrix if 1000 Simulations, Exponential Distribution

```{r}
sim <- matrix(rexp(nosim*sample_size, rate=lambda), nosim, sample_size)
row_means <- rowMeans(sim)
```


The distribution of sample means is as follows.

```{r}
# histogram
hist(row_means, breaks=40, prob=TRUE,
     main="Historgram of sample mean",
     xlab="")

# averages of samples
lines(density(row_means))

# theoretical average density 
xfit <- seq(min(row_means), max(row_means), length=100)
yfit <- dnorm(xfit, mean=1/lambda, sd=(1/lambda/sqrt(sample_size)))
lines(xfit, yfit, pch=22, col="red", lty=2)
legend('topright', c("simulation", "theoretical"), lty=c(1,2), col=c("black", "red"))
```

Theoretical Center

```{r}
μ <- 1/lambda
μ
```

```{r}
center <- mean(row_means)
```


The distribution of sample means is centered at `r center` and the theoretical center of the distribution is `r μ`. 

## Sample Variance vs Theoretical Variance


```{r}
σ <- 1/lambda/sqrt(sample_size)
σ

Var <- σ^2
Var

```

The expected standard deviation is `r σ`, the variance Var of standard deviation σ is `r Var`

```{r}

σ_x <- sd(row_means)
σ_x

Var_x <- var(row_means)
Var_x

```

Sample standard deviation is `r σ_x`, sample variance is `r Var_x`. Result: Expected and sample values are very close. 
 
## Distribution


```{r}
qqnorm(row_means)
qqline(row_means, col = 2)

```

The distribution of averages is close to a normal distribution. 
